<%page args="credit_message" />

<%!
from django.utils.translation import ugettext as _
from course_modes.models import CourseMode
from util.date_utils import get_default_time_display
%>
<%namespace name='static' file='../static_content.html'/>

<%block name="js_extra" args="credit_message">
  <%static:js group='credit_wv'/>
  <script type="text/javascript">
    $(document).ready(function() {
      $.ajaxSetup({
        headers: {
          'X-CSRFToken': $.cookie('csrftoken')
        },
        dataType: 'json'
      });
      $(".purchase-credit-btn").click(function() {
        var data = {
            user_id: "${credit_message['user_id']}",
            course_id: "${credit_message['course_id']}"
        };
        Logger.log('edx.credit.shared', data);
      });
    });
  </script>
</%block>

<div class="message message-status is-shown">
    <p>
        % if credit_message["status"] == "requirements_meet":
            <span>
            % if credit_message["urgent"]:
                ${_("Your eligibility to receive {provider} credit expires on {expiry}. Don't miss out!").format(
                        provider=credit_message["provider"]["display_name"],
                        expiry=get_default_time_display(credit_message["expiry"]),
                    )
                }
            % else:
                ${_("You are now eligible for {provider} credit. {congrats}").format(
                        provider=credit_message["provider"]["display_name"],
                        congrats="<b>Congratulations</b>",
                    )
                }
            % endif
            </span>
            <span class="purchase_credit"> <a class="btn purchase-credit-btn" href='{credit_message["provider"]["provider_url"]}' target="_blank">${_("Get credit")}</a> </span>

        % elif credit_message["status"] == "pending":
            ${_("Thank you. Your credit is processing. Please see {provider_link} for more information.").format(
                    provider_link='<a href="{}" target="_blank">{}</a>'.format(credit_message["provider"]["provider_url"],credit_message["provider"]["display_name"])
                )
            }
        % elif credit_message["status"] == "approved":
            ${_("Your credit has been processed and approved. {congrats}. Please see {provider_link} for more information.").format(
                    provider_link='<a href="{}" target="_blank">{}</a>'.format(credit_message["provider"]["provider_url"],credit_message["provider"]["display_name"]),
                )
            }
        % elif credit_message["status"] == "rejected":
            ${_("Your credit has been processed but denied. Please contact {provider_link} for more information.").format(
                    congrats="<b>Congratulations</b>",
                    provider_link='<a href="{}" target="_blank">{}</a>'.format(credit_message["provider"]["provider_url"],credit_message["provider"]["display_name"]),
                )
            }
        % endif

    </p>

</div>
