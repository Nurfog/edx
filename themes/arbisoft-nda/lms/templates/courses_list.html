## mako
<%page expression_filter="h"/>
<%namespace name='static' file='static_content.html'/>
<%! from django.utils.translation import ugettext as _ %>
<%!
    import datetime
    import pytz

    def course_available(end):
        if not end:
            return False

        tz = pytz.timezone('Asia/Karachi')
        now = datetime.datetime.now(tz=tz)
        td = end - now
        hours = int(td.seconds // (60 * 60))
        mins = int((td.seconds // 60) % 60)

        return td.days > 0 or hours > 0 or mins > 0
%>
<section class="courses-section">
  <div class="courses-container">
    <div class="highlighted-courses">

      % if settings.FEATURES.get('COURSES_ARE_BROWSABLE'):
        <section class="courses">

          <div class="grid-manual">
            <div class="row course-list">
              %for course in courses[:6]:
                  %if course.end and course_available(course.end):
                    <div class="col col-12 sm-col-12">
                      <div class="courses-listing-item">
                        <%include file="course.html" args="course=course" />
                      </div>
                    </div>
                  %endif
              %endfor
            </div>
          </div>
        </section>
      % endif

    </div>
  </div>
</section>
